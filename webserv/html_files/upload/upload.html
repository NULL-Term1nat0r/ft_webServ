<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Viewer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-image: url('../backgroundImageUpload.jpeg');
            background-color: rgba(255, 255, 255, 0.5);
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh; /* Ensure the body takes up the full viewport height */
        }

        h1 {
            color: #ff9900; /* Change to your desired color */

        }
        #imageList {
            list-style-type: none;
            padding: 0;
        }
        .imageBox {
            border: 1px solid #ddd;
            color: green;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: rgba(255, 255, 255, 0.7); /* Adjust the alpha value as needed */
        }
        .imageBox .fileName {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            cursor: pointer;
            color: #007bff !important; /* Color for the filename text */
            text-decoration: none; /* Remove default underline */
            background-color: rgba(255, 255, 255, 0.5); /* Adjust the alpha value as needed */
        }

        .imageBox .fileName:hover {
            text-decoration: underline;
            color: #004080 !important; /* Adjust the color on hover if desired */
        }
        .deleteButton {
            background-color: Matrix Regular, sans-serif;
            color: forestgreen;
            border: none;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            font-size: 16px;
            cursor: pointer;
            border-radius: 3px;
        }
    </style>
</head>
<body>

<h1>Image Viewer</h1>

<ul id="imageList"></ul>

<script>
    function deleteImage(filename) {
        var xhrDelete = new XMLHttpRequest();
        xhrDelete.open('DELETE', '/upload/' + encodeURIComponent(filename), true);

        xhrDelete.onload = function() {
            if (xhrDelete.status >= 200 && xhrDelete.status < 400) {
                // Reload the image list after successful deletion
                fetchImageList();
            } else {
                console.error('Failed to delete image:', xhrDelete.responseText);
            }
        };

        xhrDelete.send();
    }

    function fetchImageList() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/upload/getImages.php', true);

        xhr.onload = function() {
            if (xhr.status >= 200 && xhr.status < 400) {
                // Parse JSON response
                var data = JSON.parse(xhr.responseText);

                // Check if data is an object
                if (typeof data === 'object' && data !== null) {
                    // Display images as hyperlinks with delete buttons
                    var imageList = document.getElementById('imageList');
                    imageList.innerHTML = ''; // Clear previous list

                    for (var key in data) {
                        if (data.hasOwnProperty(key)) {
                            var image = data[key];

                            var listItem = document.createElement('li');
                            listItem.className = 'imageBox';

                            var fileNameContainer = document.createElement('a');
                            fileNameContainer.className = 'fileName';
                            fileNameContainer.textContent = image;
                            fileNameContainer.href = '/upload/' + encodeURIComponent(image) + '?timestamp=' + Date.now();
                            fileNameContainer.onclick = function(filename) {
                                return function(event) {
                                    // Prevent the delete button from being triggered when the file name is clicked
                                    event.stopPropagation();
                                    // Open the image in a new page with a unique query parameter
                                    window.open('/upload/' + encodeURIComponent(filename));
                                };
                            }(image);

                            var deleteButton = document.createElement('button');
                            deleteButton.className = 'deleteButton';
                            deleteButton.textContent = 'Delete';
                            deleteButton.onclick = function(filename) {
                                return function() {
                                    // Call deleteImage with the corresponding filename
                                    deleteImage(filename);
                                };
                            }(image);

                            listItem.appendChild(fileNameContainer);
                            listItem.appendChild(deleteButton);

                            imageList.appendChild(listItem);
                        }
                    }
                } else {
                    console.error('Data is not an object:', data);
                }
            }
        };

        xhr.send();
    }

    // Initial fetch of image list
    fetchImageList();
</script>

</body>
</html>











<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Image Viewer</title>-->
<!--    <style>-->
<!--        body {-->
<!--            font-family: Arial, sans-serif;-->
<!--            margin: 20px;-->
<!--        }-->
<!--        #imageList {-->
<!--            list-style-type: none;-->
<!--            padding: 0;-->
<!--        }-->
<!--        #imageList li {-->
<!--            margin-bottom: 10px;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<h1>Image Viewer</h1>-->

<!--<ul id="imageList"></ul>-->

<!--<script>-->
<!--    // Fetch image filenames using XMLHttpRequest-->
<!--    var xhr = new XMLHttpRequest();-->
<!--    xhr.open('GET', '/upload/getImages.php', true);-->

<!--    xhr.onload = function() {-->
<!--        if (xhr.status >= 200 && xhr.status < 400) {-->
<!--            // Parse JSON response-->
<!--            var data = JSON.parse(xhr.responseText);-->

<!--            // Check if data is an object-->
<!--            if (typeof data === 'object' && data !== null) {-->
<!--                // Display images as hyperlinks in the list-->
<!--                var imageList = document.getElementById('imageList');-->
<!--                for (var key in data) {-->
<!--                    if (data.hasOwnProperty(key)) {-->
<!--                        var image = data[key];-->
<!--                        var listItem = document.createElement('li');-->
<!--                        var link = document.createElement('a');-->
<!--                        link.href = '/upload/' + encodeURIComponent(image); // Encode the image filename-->
<!--                        link.textContent = image;-->
<!--                        listItem.appendChild(link);-->
<!--                        imageList.appendChild(listItem);-->
<!--                    }-->
<!--                }-->
<!--            } else {-->
<!--                console.error('Data is not an object:', data);-->
<!--            }-->
<!--        }-->
<!--    };-->

<!--    xhr.send();-->
<!--</script>-->

<!--</body>-->
<!--</html>-->
